{{ define "main" }}
<div class='contact center-column'>
  <h1>{{ .Title }}</h1>
  <div class="subtitle">
  {{ .Content | emojify }}
  </div>
  <div class="flex-row contact-form"> 
       <form
         id="contact_form">
          <div class="form-group">
            <label for="Name">Name</label>
            <input type="text" name="Name" placeholder="Your full name" required/>
          </div>
          <div class="form-group">
            <label for="Email">Email</label>
            <input type="email" name="Email" placeholder="me@company.com" required/>
          </div>
          <div class="form-group">
            <label for="Message">Message</label>
            <textarea name="Message" placeholder="Your message..." rows="10"></textarea>
          </div>

          <div class='submit-group'>
            <button type="submit" id="contact_submit">send</button>
          </div>
        </form>
        <div class="contact-col">
          <div class="logo-section">
            <img src={{ .Params.image }}/>
          </div>
          <div>
            <ul class="contact-icons">
              <li>   
                <a href="https://github.com/ii">
                  <div id="github" class="icon">
                      <i class="fab fa-github"></i>
                  </div>
                </a>
              </li>
              <li>
                <a href="https://gitlab.com/ii">
                  <div class="icon">
                    <i class="fab fa-gitlab"></i>
                  </div>
                </a>
              </li>
              <li>
                <a href="mailto:hello@ii.nz">
                  <div class="icon">
                    <i class="fas fa-envelope"></i>
                </div>
                </a>
              </li>
              <li>
                <a href="https://www.linkedin.com/company/99165471/" target="_blank" rel="noopener noreferrer">
                  <div class="icon">
                    <i class="fab fa-linkedin"></i>
                  </div>
                </a>
              </li>
              
            </ul>
          </div>
        </div>
       

  </div>
        <script>
        const scriptURL='https://script.google.com/macros/s/AKfycbzip-YaZaOmH-_ngKyCHOCsq2MxyfZjIyb18qg9xW4daJktfL3B09agnXLUdvXKfdP4pQ/exec'
        const contactForm = document.querySelector("#contact_form")
        const submitButton = document.querySelector("#contact_submit")

       function switchToSuccessMessage(id) {
        let div = document.createElement('div');
        let p = document.createElement('p');
        p.textContent = 'Thank you! We will reach out to you soon.';
        let a = document.createElement('a');
        a.classList.add('underlined');
        a.href = '/';
        a.textContent = 'return home';
        div.append(p,a);
        let elem = document.querySelector(id);
        elem.replaceWith(div);
       }

        contactForm.addEventListener('submit', e => {
          submitButton.disabled = true
          submitButton.textContent = 'sending request';
          e.preventDefault()
          const requestForm = new FormData(contactForm)
          fetch(scriptURL, { method: 'POST', body: requestForm})
            .then(response => {
            switchToSuccessMessage('#contact_form');
            })
            .catch(error => {
            alert('Error!', error.message)
            submitButton.disabled = false;
            })
        });
    </script>
</div>
{{ end }}
